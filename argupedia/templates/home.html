{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{% block content %}

    <div class="container-fluid">
        <section class="search-banner bg-light text-black py-4 bg-white text-dark" id="banner">
            <div class="row" >
                <div class="col-lg-7">
                    <div class="row ml-2" >
                        <h3 class="pl-3">Top Topics</h3>
                    </div>
                    <div class="row ml-2" >
                        {% if not user.is_authenticated %}
                            <h7 class="pl-3"><a href="accounts/login">Log-in</a> or <a href="accounts/signup">Register</a> to add a discussion!</h7>
                        {% endif %}
                    </div>
                </div>
                {% if user.is_authenticated %}
                    <div class="col-lg-4 text-right">
                        <div class="btn-group">
                            <a href="#" class="btn btn-dark btn-md active">Create Debate</a>
                        </div>
                    </div>
                {% endif %}
            </div>
        </section>
    </div>

    {% load mptt_tags %}
    <ul class="entry" style="padding-left: 38px;">
        {% if not entries %}
            <h6>Oops. There are no discussions to show.</h6>
        {% endif %}
        {% recursetree entries %}
            {% if node.user.pk == user.pk %}
                <li class="usernode">
                    {% elif node.is_root_node %}
                <li class="rootnode">
                    {% elif node.user.pk == node.get_root.user.pk %}
                <li class="opnode">
                    {% else %}
                <li class="commentnode">
            {% endif %}
        <div class="entryBox">
            <a class="entry-anchor" id="{{ node.pk }}"></a>
            <p style="margin-bottom: 1px">
                <a href="#userdetailview" style="margin-left: 5px; font-size: 14px;"><strong>{{node.user.username }}</strong></a>
                <small><em>Votes:</em></small>
                <strong class="entry-points" data-id="{{node.pk}}">{{ node.votes_sum }}</strong>
                {% if user.is_authenticated %}
                    {% if not node.deleted %}
                        <button class="upvote {% if user in node.upvotes.all %}user-upvoted{% endif %}" data-id="{{node.pk}}">&#43;</button>
                        <button class="downvote {% if user in node.downvotes.all %}user-downvoted{% endif %}" data-id="{{node.pk}}">&#8722;</button>
                    {% endif %}
                    <a href="#" class="answerButton" value="{{node.pk}}" style="font-size: 12px">answer</a>
                    {% if node.user.pk == user.pk and not node.deleted %}
                        <a href="#" class="editButton" value="{{node.pk}}" style="font-size: 12px">edit</a>
                        <a href="#" class="deleteButton" value="{{node.pk}}" style="font-size: 12px; color: red;">delete</a>
                    {% endif %}
                {% endif %}
            </p>
            <div id="content{{node.pk}}" class="entry-content {% if node.deleted %}deleted text-muted{% endif %}" value="{{node.pk}}" style="{% if entry.pk == node.pk %}background-color: yellow;{% endif %}">{{node.content_formatted|safe }}</div>
        </div>
        {% if node.has_hidden_children %}
            <a style="margin-left: 15px; font-size: 12px; background-color: lightblue; color: white;" href="#expanddiscussion">Continue into this discussion -></a>
        {% endif %}
        {% if not node.is_leaf_node %}
            {% if node.is_root_node %}
                <div style="margin-bottom: 12px;"></div>
            {% endif %}
            <ul class="children entry" style="padding-left: 25px">
                {{ children }}
            </ul>
        {% endif %}
        </li>
            {% if node.is_root_node %}
                <hr>
            {% endif %}
        {% endrecursetree %}

        <div class="pagination">
    <span class="step-links">
        {% if entries.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ entries.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ entries.number }} of {{ entries.paginator.num_pages }}.
        </span>

        {% if entries.has_next %}
            <a href="?page={{ entries.next_page_number }}">next</a>
            <a href="?page={{ entries.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
        </div>

{% endblock %}